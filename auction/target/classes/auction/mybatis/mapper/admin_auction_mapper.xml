<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="auction.repository.auction.AuctionDaoImpl">
	<insert id="regist" parameterType="auction">
		insert into auction_main values(
			auction_seq.nextval,
			#{auction_nm},
			#{auction_info},
			sysdate,
			#{auction_addr1},
			#{auction_start},
			#{auction_end},
			#{auction_type},
			#{auction_post},
			#{auction_addr2},
			#{auction_image}
			)
	</insert>
	
	<select id="list" resultType="auction">
		select * from auction_main order by auction_sq desc
	</select>
	
	<select id="listPage" resultType="auction" parameterType="map">
		select X.* from (
					select rownum as rn, A.* from (
		<choose>
			<when test="sortType != null and sortType.equalsIgnoreCase('nm')">
				select * from auction_main order by auction_nm asc) A 
			</when>
			<when test="sortType != null and sortType.equalsIgnoreCase('nmReverse')">
				select * from auction_main order by auction_nm desc) A 
			</when>
			<when test="sortType != null and sortType.equalsIgnoreCase('type')">
				select * from auction_main order by auction_type desc) A 
			</when>
			<when test="sortType != null and sortType.equalsIgnoreCase('typeReverse')">
				select * from auction_main order by auction_type asc) A 
			</when>
			<when test="sortType != null and sortType.equalsIgnoreCase('dtReverse')">
				select * from auction_main order by auction_sq asc) A 
			</when>
			<otherwise>
				select * from auction_main order by auction_sq desc) A 
			</otherwise>
		</choose>
					where rownum <![CDATA[ <= ]]> #{page.endIndex}) X
		where X.rn <![CDATA[ >= ]]> #{page.startIndex}
	</select>
	
	<select id="listCnt" resultType="int">
		select count(*) from auction_main
	</select>
	
	<select id="search" resultType="auction" parameterType="map">
		select X.* from (
					select rownum as rn, A.* from (
		<choose>
			<when test="sortType != null and sortType.equalsIgnoreCase('nm')">
				select * from auction_main where ${searchType} like '%'||#{searchKey}||'%' order by auction_nm asc) A 
			</when>
			<when test="sortType != null and sortType.equalsIgnoreCase('nmReverse')">
				select * from auction_main where ${searchType} like '%'||#{searchKey}||'%' order by auction_nm desc) A 
			</when>
			<when test="sortType != null and sortType.equalsIgnoreCase('type')">
				select * from auction_main where ${searchType} like '%'||#{searchKey}||'%' order by auction_type desc) A 
			</when>
			<when test="sortType != null and sortType.equalsIgnoreCase('typeReverse')">
				select * from auction_main where ${searchType} like '%'||#{searchKey}||'%' order by auction_type asc) A 
			</when>
			<when test="sortType != null and sortType.equalsIgnoreCase('dtReverse')">
				select * from auction_main where ${searchType} like '%'||#{searchKey}||'%' order by auction_sq asc) A 
			</when>
			<otherwise>
				select * from auction_main where ${searchType} like '%'||#{searchKey}||'%' order by auction_sq desc) A 
			</otherwise>
		</choose>
					where rownum <![CDATA[ <= ]]> #{page.endIndex}) X
			where X.rn <![CDATA[ >= ]]> #{page.startIndex}
	</select>
	
	<select id="searchCnt" resultType="int" parameterType="map">
		select count(*) from auction_main where ${searchType} like '%'||#{searchKey}||'%'
	</select>
	
	<select id="find" resultType="auction" parameterType="int">
		select * from auction_main where auction_sq=#{auction_sq}
	</select>
	
	<update id="edit" parameterType="auction">
		update auction_main set 
			auction_nm=#{auction_nm}, 
			auction_info=#{auction_info}, 
			auction_addr1=#{auction_addr1}, 
			auction_start=#{auction_start}, 
			auction_end=#{auction_end}, 
			auction_type=#{auction_type}, 
			auction_post=#{auction_post}, 
			auction_addr2=#{auction_addr2},
			auction_image=#{auction_image}
		where auction_sq=#{auction_sq}
	</update>
	
	<delete id="delete" parameterType="int">
		delete from auction_main where auction_sq=#{auction_sq}
	</delete>
	
	<delete id="deleteAll">
		delete from auction_main
	</delete>
		
</mapper>


